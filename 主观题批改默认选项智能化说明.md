# 主观题批改默认选项智能化修复说明

## 修改内容

修改了教师面板中主观题批改选项的默认选择逻辑，使其根据AI批改功能的配置状态智能选择默认选项。

## 具体修改

### 1. 修改默认选择逻辑

**文件**: `templates/teacher_dashboard.html`

**修改位置**: `checkAIGradingStatus()` 函数

**修改前**:
- 人工批改始终为默认选中状态（HTML中设置 `checked`）
- AI不可用时强制选择人工批改
- AI可用时不改变默认选择

**修改后**:
- 移除HTML中的默认选中状态（`checked` 属性）
- AI配置测试通过时，默认选择AI批改
- AI配置测试失败时，默认选择人工批改

### 2. 修改的代码段

```javascript
// AI配置测试通过时的处理
if (data.enabled) {
    aiRadio.disabled = false;
    aiRadio.style.opacity = '1';
    aiLabel.style.opacity = '1';
    aiLabel.style.color = '';
    
    statusText.style.display = 'none';
    
    // AI配置测试通过，默认选择AI批改
    aiRadio.checked = true;
    manualRadio.checked = false;
} else {
    // AI不可用时的处理
    aiRadio.disabled = true;
    aiRadio.style.opacity = '0.4';
    aiLabel.style.opacity = '0.5';
    aiLabel.style.color = '#6c757d';
    
    statusText.style.display = 'none';
    
    // 如果AI不可用，默认选择人工批改
    manualRadio.checked = true;
    aiRadio.checked = false;
}
```

### 3. HTML结构修改

移除了人工批改选项的默认选中状态：

```html
<!-- 修改前 -->
<input class="form-check-input" type="radio" name="short_answer_grading_method" id="manual_grading" value="manual" checked>

<!-- 修改后 -->
<input class="form-check-input" type="radio" name="short_answer_grading_method" id="manual_grading" value="manual">
```

## 功能效果

1. **智能默认选择**: 系统会自动检测AI批改功能的配置状态
2. **AI可用时**: 默认选择"AI批改"选项
3. **AI不可用时**: 默认选择"人工批改"选项
4. **用户体验优化**: 减少用户手动选择的操作，提高使用效率
5. **兼容性保持**: 预设加载和其他功能保持不变

## 测试建议

1. 测试AI配置正确时的默认选择
2. 测试AI配置错误时的默认选择
3. 测试预设加载时的批改方式设置
4. 测试用户手动切换选项的功能

## 注意事项

- 此修改不影响已保存的预设配置
- 用户仍可手动切换批改方式
- AI配置状态检查在页面加载时自动执行