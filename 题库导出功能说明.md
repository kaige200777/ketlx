# 题库导出功能说明

## 功能概述

题库导出功能允许教师将题库中的所有题目导出为 Excel 文件，方便备份、编辑和分享。

## 使用方法

### 1. 进入题库详情页面

1. 登录教师账号
2. 在教师控制面板中，点击任意题库名称
3. 进入题库详情页面

### 2. 导出题库

1. 在题库详情页面右上角，点击 **"导出题库"** 按钮
2. 浏览器会自动下载 Excel 文件
3. 文件名格式：`题库名_题型_日期时间.xlsx`
   - 例如：`信息技术_单选题_20251212_105030.xlsx`

## 导出格式

### 单选题 / 多选题

| 题目 | 选项A | 选项B | 选项C | 选项D | 正确答案 | 分值 | 解析 |
|------|-------|-------|-------|-------|----------|------|------|
| ... | ... | ... | ... | ... | A | 4 | ... |

### 判断题

| 题目 | 正确答案 | 分值 | 解析 |
|------|----------|------|------|
| ... | 正确 | 3 | ... |

### 填空题

| 题目 | 正确答案 | 分值 | 解析 |
|------|----------|------|------|
| ... | ... | 5 | ... |

### 简答题

| 题目 | 参考答案 | 分值 | 解析 |
|------|----------|------|------|
| ... | ... | 10 | ... |

## 导出文件用途

### 1. 备份题库
- 定期导出题库作为备份
- 防止数据丢失

### 2. 编辑题目
- 在 Excel 中批量编辑题目
- 修改后重新导入

### 3. 分享题库
- 将题库分享给其他教师
- 跨系统使用题库

### 4. 打印试卷
- 导出后可以格式化打印
- 制作纸质试卷

## 注意事项

### 1. 空题库无法导出
- 如果题库中没有题目，会提示"题库为空，无法导出"
- 请先添加题目后再导出

### 2. 图片内容
- 如果题目中包含图片（以 `![图片](URL)` 格式），导出时会保留原始文本
- 图片不会嵌入到 Excel 文件中

### 3. 文件编码
- 导出的 Excel 文件使用 UTF-8 编码
- 可以在 Excel、WPS 等软件中正常打开

### 4. 权限要求
- 只有教师账号可以导出题库
- 学生账号无法访问导出功能

## 重新导入

导出的 Excel 文件可以重新导入到系统中：

1. 在教师控制面板选择对应题型
2. 点击"导入题库"按钮
3. 选择导出的 Excel 文件
4. 系统会自动识别格式并导入

## 技术细节

### 实现方式
- 使用 pandas 和 openpyxl 库生成 Excel 文件
- 文件在内存中生成，不占用磁盘空间
- 支持大量题目的导出

### 文件格式
- 文件格式：`.xlsx` (Excel 2007+)
- MIME 类型：`application/vnd.openxmlformats-officedocument.spreadsheetml.sheet`

### 性能
- 导出速度取决于题目数量
- 一般情况下，1000 道题目可在 1-2 秒内完成导出

## 常见问题

### Q1: 导出按钮点击后没有反应？
**A:** 检查以下几点：
- 确认已登录教师账号
- 检查浏览器是否阻止了下载
- 查看浏览器控制台是否有错误信息

### Q2: 导出的文件打不开？
**A:** 可能的原因：
- 文件下载不完整，重新导出
- Excel 版本过低，使用 Excel 2007 或更高版本
- 使用 WPS 或其他兼容软件打开

### Q3: 导出后题目格式乱了？
**A:** 
- 题目中的换行符会保留
- 在 Excel 中可以调整单元格格式
- 建议使用"自动换行"功能

### Q4: 可以导出多个题库吗？
**A:** 
- 目前只支持单个题库导出
- 如需导出多个题库，请分别导出
- 可以在 Excel 中手动合并

### Q5: 导出的文件可以修改吗？
**A:** 
- 可以在 Excel 中修改
- 修改后可以重新导入系统
- 注意保持列名和格式不变

## 更新日志

### v1.1.0 (2025-12-12)
- ✅ 新增题库导出功能
- ✅ 支持所有题型导出
- ✅ 自动生成文件名
- ✅ 内存中生成文件，提高性能

---
**最后更新**: 2025-12-12
